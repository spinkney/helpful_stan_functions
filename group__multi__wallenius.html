<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.2"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Helpful Stan Functions: Multivariate Wallenius&#39; Noncentral Hypergeometric Distribution Functions</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
		<link rel="stylesheet" href="sean-theme.css">
		<script src="highlight.min.js"></script>
		<script>
		(function (w, d) {
    'use strict';
    var TABLE_NAME = 'hljs-ln',
        LINE_NAME = 'hljs-ln-line',
        CODE_BLOCK_NAME = 'hljs-ln-code',
        NUMBERS_BLOCK_NAME = 'hljs-ln-numbers',
        NUMBER_LINE_NAME = 'hljs-ln-n',
        DATA_ATTR_NAME = 'data-line-number',
        BREAK_LINE_REGEXP = /\r\n|\r|\n/g;
    if (w.hljs) {
        w.hljs.initLineNumbersOnLoad = initLineNumbersOnLoad;
        w.hljs.lineNumbersBlock = lineNumbersBlock;
        w.hljs.lineNumbersValue = lineNumbersValue;
        addStyles();
    } else {
        w.console.error('highlight.js not detected!');
    }
    function isHljsLnCodeDescendant(domElt) {
        var curElt = domElt;
        while (curElt) {
            if (curElt.className && curElt.className.indexOf('hljs-ln-code') !== -1) {
                return true;
            }
            curElt = curElt.parentNode;
        }
        return false;
    }
    function getHljsLnTable(hljsLnDomElt) {
        var curElt = hljsLnDomElt;
        while (curElt.nodeName !== 'TABLE') {
            curElt = curElt.parentNode;
        }
        return curElt;
    }
    // Function to workaround a copy issue with Microsoft Edge.
    // Due to hljs-ln wrapping the lines of code inside a <table> element,
    // itself wrapped inside a <pre> element, window.getSelection().toString()
    // does not contain any line breaks. So we need to get them back using the
    // rendered code in the DOM as reference.
    function edgeGetSelectedCodeLines(selection) {
        // current selected text without line breaks
        var selectionText = selection.toString();
        // get the <td> element wrapping the first line of selected code
        var tdAnchor = selection.anchorNode;
        while (tdAnchor.nodeName !== 'TD') {
            tdAnchor = tdAnchor.parentNode;
        }
        // get the <td> element wrapping the last line of selected code
        var tdFocus = selection.focusNode;
        while (tdFocus.nodeName !== 'TD') {
            tdFocus = tdFocus.parentNode;
        }
        // extract line numbers
        var firstLineNumber = parseInt(tdAnchor.dataset.lineNumber);
        var lastLineNumber = parseInt(tdFocus.dataset.lineNumber);
        // multi-lines copied case
        if (firstLineNumber != lastLineNumber) {
            var firstLineText = tdAnchor.textContent;
            var lastLineText = tdFocus.textContent;
            // if the selection was made backward, swap values
            if (firstLineNumber > lastLineNumber) {
                var tmp = firstLineNumber;
                firstLineNumber = lastLineNumber;
                lastLineNumber = tmp;
                tmp = firstLineText;
                firstLineText = lastLineText;
                lastLineText = tmp;
            }
            // discard not copied characters in first line
            while (selectionText.indexOf(firstLineText) !== 0) {
                firstLineText = firstLineText.slice(1);
            }
            // discard not copied characters in last line
            while (selectionText.lastIndexOf(lastLineText) === -1) {
                lastLineText = lastLineText.slice(0, -1);
            }
            // reconstruct and return the real copied text
            var selectedText = firstLineText;
            var hljsLnTable = getHljsLnTable(tdAnchor);
            for (var i = firstLineNumber + 1 ; i < lastLineNumber ; ++i) {
                var codeLineSel = format('.{0}[{1}="{2}"]', [CODE_BLOCK_NAME, DATA_ATTR_NAME, i]);
                var codeLineElt = hljsLnTable.querySelector(codeLineSel);
                selectedText += '\n' + codeLineElt.textContent;
            }
            selectedText += '\n' + lastLineText;
            return selectedText;
        // single copied line case
        } else {
            return selectionText;
        }
    }
    // ensure consistent code copy/paste behavior across all browsers
    // (see https://github.com/wcoder/highlightjs-line-numbers.js/issues/51)
    document.addEventListener('copy', function(e) {
        // get current selection
        var selection = window.getSelection();
        // override behavior when one wants to copy line of codes
        if (isHljsLnCodeDescendant(selection.anchorNode)) {
            var selectionText;
            // workaround an issue with Microsoft Edge as copied line breaks
            // are removed otherwise from the selection string
            if (window.navigator.userAgent.indexOf('Edge') !== -1) {
                selectionText = edgeGetSelectedCodeLines(selection);
            } else {
                // other browsers can directly use the selection string
                selectionText = selection.toString();
            }
            e.clipboardData.setData('text/plain', selectionText);
            e.preventDefault();
        }
    });
    function addStyles () {
        var css = d.createElement('style');
        css.type = 'text/css';
        css.innerHTML = format(
            '.{0}{border-collapse:collapse}' +
            '.{0} td{padding:1}' +
            '.{1}:before{content:attr({2})}',
        [
            TABLE_NAME,
            NUMBER_LINE_NAME,
            DATA_ATTR_NAME
        ]);
        d.getElementsByTagName('head')[0].appendChild(css);
    }
    function initLineNumbersOnLoad (options) {
        if (d.readyState === 'interactive' || d.readyState === 'complete') {
            documentReady(options);
        } else {
            w.addEventListener('DOMContentLoaded', function () {
                documentReady(options);
            });
        }
    }
    function documentReady (options) {
        try {
            var blocks = d.querySelectorAll('code.hljs,code.nohighlight');
            for (var i in blocks) {
                if (blocks.hasOwnProperty(i)) {
                    if (!isPluginDisabledForBlock(blocks[i])) {
                        lineNumbersBlock(blocks[i], options);
                    }
                }
            }
        } catch (e) {
            w.console.error('LineNumbers error: ', e);
        }
    }
    function isPluginDisabledForBlock(element) {
        return element.classList.contains('nohljsln');
    }
    function lineNumbersBlock (element, options) {
        if (typeof element !== 'object') return;
        async(function () {
            element.innerHTML = lineNumbersInternal(element, options);
        });
    }
    function lineNumbersValue (value, options) {
        if (typeof value !== 'string') return;
        var element = document.createElement('code')
        element.innerHTML = value
        return lineNumbersInternal(element, options);
    }
    function lineNumbersInternal (element, options) {
        var internalOptions = mapOptions(element, options);
        duplicateMultilineNodes(element);
        return addLineNumbersBlockFor(element.innerHTML, internalOptions);
    }
    function addLineNumbersBlockFor (inputHtml, options) {
        var lines = getLines(inputHtml);
        // if last line contains only carriage return remove it
        if (lines[lines.length-1].trim() === '') {
            lines.pop();
        }
        if (lines.length > 1 || options.singleLine) {
            var html = '';
            for (var i = 0, l = lines.length; i < l; i++) {
                html += format(
                    '<tr>' +
                        '<td class="{0} {1}" {3}="{5}">' +
                            '<div class="{2}" {3}="{5}"></div>' +
                        '</td>' +
                        '<td class="{0} {4}" {3}="{5}">' +
                            '{6}' +
                        '</td>' +
                    '</tr>',
                [
                    LINE_NAME,
                    NUMBERS_BLOCK_NAME,
                    NUMBER_LINE_NAME,
                    DATA_ATTR_NAME,
                    CODE_BLOCK_NAME,
                    i + options.startFrom,
                    lines[i].length > 0 ? lines[i] : ' '
                ]);
            }
            return format('<table class="{0}">{1}</table>', [ TABLE_NAME, html ]);
        }
        return inputHtml;
    }
    /**
     * @param {HTMLElement} element Code block.
     * @param {Object} options External API options.
     * @returns {Object} Internal API options.
     */
    function mapOptions (element, options) {
        options = options || {};
        return {
            singleLine: getSingleLineOption(options),
            startFrom: getStartFromOption(element, options)
        };
    }
    function getSingleLineOption (options) {
        var defaultValue = false;
        if (!!options.singleLine) {
            return options.singleLine;
        }
        return defaultValue;
    }
    function getStartFromOption (element, options) {
        var defaultValue = 1;
        var startFrom = defaultValue;
        if (isFinite(options.startFrom)) {
            startFrom = options.startFrom;
        }
        // can be overridden because local option is priority
        var value = getAttribute(element, 'data-ln-start-from');
        if (value !== null) {
            startFrom = toNumber(value, defaultValue);
        }
        return startFrom;
    }
    /**
     * Recursive method for fix multi-line elements implementation in highlight.js
     * Doing deep passage on child nodes.
     * @param {HTMLElement} element
     */
    function duplicateMultilineNodes (element) {
        var nodes = element.childNodes;
        for (var node in nodes) {
            if (nodes.hasOwnProperty(node)) {
                var child = nodes[node];
                if (getLinesCount(child.textContent) > 0) {
                    if (child.childNodes.length > 0) {
                        duplicateMultilineNodes(child);
                    } else {
                        duplicateMultilineNode(child.parentNode);
                    }
                }
            }
        }
    }
    /**
     * Method for fix multi-line elements implementation in highlight.js
     * @param {HTMLElement} element
     */
    function duplicateMultilineNode (element) {
        var className = element.className;
        if ( ! /hljs-/.test(className)) return;
        var lines = getLines(element.innerHTML);
        for (var i = 0, result = ''; i < lines.length; i++) {
            var lineText = lines[i].length > 0 ? lines[i] : ' ';
            result += format('<span class="{0}">{1}</span>\n', [ className,  lineText ]);
        }
        element.innerHTML = result.trim();
    }
    function getLines (text) {
        if (text.length === 0) return [];
        return text.split(BREAK_LINE_REGEXP);
    }
    function getLinesCount (text) {
        return (text.trim().match(BREAK_LINE_REGEXP) || []).length;
    }
    ///
    /// HELPERS
    ///
    function async (func) {
        w.setTimeout(func, 0);
    }
    /**
     * {@link https://wcoder.github.io/notes/string-format-for-string-formating-in-javascript}
     * @param {string} format
     * @param {array} args
     */
    function format (format, args) {
        return format.replace(/\{(\d+)\}/g, function(m, n){
            return args[n] !== undefined ? args[n] : m;
        });
    }
    /**
     * @param {HTMLElement} element Code block.
     * @param {String} attrName Attribute name.
     * @returns {String} Attribute value or empty.
     */
    function getAttribute (element, attrName) {
        return element.hasAttribute(attrName) ? element.getAttribute(attrName) : null;
    }
    /**
     * @param {String} str Source string.
     * @param {Number} fallback Fallback value.
     * @returns Parsed number or fallback value.
     */
    function toNumber (str, fallback) {
        if (!str) return fallback;
        var number = Number(str);
        return isFinite(number) ? number : fallback;
    }
}(window, document));		
		$(function() {
        	$(".fragment").each(function(i,node) {
          	var $node = $(node);
			$node.children(":not(.line)").remove();
          	$node.html("<pre><code class='stan'>" + $node.text().trim().replaceAll("\<", "&lt;").replaceAll("\>", "&gt;") + "</code></pre>");
             hljs.highlightAll(node);
		     hljs.initLineNumbersOnLoad(node);  
     		});
		});
	</script>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><img alt="Logo" src="helpful_logo2_crop.png"/></td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Helpful Stan Functions
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__multi__wallenius.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Multivariate Wallenius' Noncentral Hypergeometric Distribution Functions<div class="ingroups"><a class="el" href="group__multivariate.html">Multivariate Distributions</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaad1c6d45dab33e14585efdd01a763f85"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multi__wallenius.html#gaad1c6d45dab33e14585efdd01a763f85">multi_wallenius_integral</a> (real t, real xc, array[] real theta, array[] real x_r, array[] int x_i)</td></tr>
<tr class="separator:gaad1c6d45dab33e14585efdd01a763f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1b1c12f44019e532e76219190c0d96c"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__multi__wallenius.html#gac1b1c12f44019e532e76219190c0d96c">multi_wallenius_lpmf</a> (data array[] int k, vector m, vector p, data array[] real x_r, data real tol)</td></tr>
<tr class="separator:gac1b1c12f44019e532e76219190c0d96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >The probability mass function of the multivariate Wallenius' hypergeometric distribution is given by </p><p class="formulaDsp">
\[ f(\mathbf{x} \mid \mathbf{m}, \mathbf{\omega}) = \left(\prod_{i=1}^c \binom{m_i}{x_i} \right) \int_0^1 \prod_{i=1}^c (1-t^{\omega_i/D})^{x_i} \operatorname{d}t \]
</p>
<p> where \( \mathbf{m} = (m_1, \ldots, m_c) \in \mathbb{N}^c \) is the size of each \(c\) group of the population. The population is given by \( N = \sum_{i=1}^c m_i \) where the realizations from each group is given by \( \mathbf{x} \). The weights of each group are contained in the \(c\)-sized simplex \( \mathbf{\omega} \) and \( D \) is </p><p class="formulaDsp">
\[ D = \mathbf{\omega} \cdot (\mathbf{m} - \mathbf{x})) = \sum_{i=1}^c \omega_i(m_i - x_i). \]
</p>
<div class="fragment"><div class="line"> </div>
<div class="line">real <a class="code hl_function" href="group__multi__wallenius.html#gaad1c6d45dab33e14585efdd01a763f85">multi_wallenius_integral</a>(real t, <span class="comment">// Function argument</span></div>
<div class="line">                              real xc, array[] real theta, <span class="comment">// parameters</span></div>
<div class="line">                              array[] real x_r, <span class="comment">// data (real)</span></div>
<div class="line">                              array[] <span class="keywordtype">int</span> x_i) {</div>
<div class="line">  <span class="comment">// data (integer)</span></div>
<div class="line">  real Dinv = 1 / theta[1];</div>
<div class="line">  <span class="keywordtype">int</span> Cp1 = num_elements(x_i);</div>
<div class="line">  <span class="keywordtype">int</span> n = x_i[1];</div>
<div class="line">  real v = 1;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">for</span> (i in 2 : Cp1) </div>
<div class="line">    v *= pow(1 - t ^ (theta[i] * Dinv), x_i[i]);</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> v;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">real <a class="code hl_function" href="group__multi__wallenius.html#gac1b1c12f44019e532e76219190c0d96c">multi_wallenius_lpmf</a>(data array[] <span class="keywordtype">int</span> k, vector m, vector p, data array[] real x_r,</div>
<div class="line">                          data real tol) {</div>
<div class="line">  <span class="keywordtype">int</span> C = num_elements(m);</div>
<div class="line">  real D = dot_product(to_row_vector(p), (m - to_vector(k[2 : C + 1])));</div>
<div class="line">  real lp = log(integrate_1d(<a class="code hl_function" href="group__multi__wallenius.html#gaad1c6d45dab33e14585efdd01a763f85">multi_wallenius_integral</a>, 0, 1,</div>
<div class="line">                             append_array({D}, to_array_1d(p)), x_r, k, tol));</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">for</span> (i in 1 : C) </div>
<div class="line">    lp += -log1p(m[i]) - lbeta(m[i] - k[i + 1] + 1, k[i + 1] + 1);</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> lp;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__multi__wallenius_html_gaad1c6d45dab33e14585efdd01a763f85"><div class="ttname"><a href="group__multi__wallenius.html#gaad1c6d45dab33e14585efdd01a763f85">multi_wallenius_integral</a></div><div class="ttdeci">real multi_wallenius_integral(real t, real xc, array[] real theta, array[] real x_r, array[] int x_i)</div><div class="ttdef"><b>Definition:</b> multi_wallenius_hypergeometric.stanfunctions:36</div></div>
<div class="ttc" id="agroup__multi__wallenius_html_gac1b1c12f44019e532e76219190c0d96c"><div class="ttname"><a href="group__multi__wallenius.html#gac1b1c12f44019e532e76219190c0d96c">multi_wallenius_lpmf</a></div><div class="ttdeci">real multi_wallenius_lpmf(data array[] int k, vector m, vector p, data array[] real x_r, data real tol)</div><div class="ttdef"><b>Definition:</b> multi_wallenius_hypergeometric.stanfunctions:70</div></div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gaad1c6d45dab33e14585efdd01a763f85" name="gaad1c6d45dab33e14585efdd01a763f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad1c6d45dab33e14585efdd01a763f85">&#9670;&nbsp;</a></span>multi_wallenius_integral()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real multi_wallenius_integral </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>xc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]real&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]real&#160;</td>
          <td class="paramname"><em>x_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int&#160;</td>
          <td class="paramname"><em>x_i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Multivariate Wallenius' Noncentral Hypergeometric Integral</p>
<p class="formulaDsp">
\[ I(t \mid \mathbf{\omega}, D) = \int_0^1 \prod_{i=1}^c (1-t^{\omega_i/D})^{x_i} \operatorname{d}t \]
</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Sean Pinkney 2021</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Real number on [0,1] </td></tr>
    <tr><td class="paramname">xc</td><td></td></tr>
    <tr><td class="paramname">theta</td><td>Array of real parameters </td></tr>
    <tr><td class="paramname">x_r</td><td>Array of data (real) </td></tr>
    <tr><td class="paramname">x_i</td><td>Array of data (integer) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>integrand </dd></dl>

</div>
</div>
<a id="gac1b1c12f44019e532e76219190c0d96c" name="gac1b1c12f44019e532e76219190c0d96c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1b1c12f44019e532e76219190c0d96c">&#9670;&nbsp;</a></span>multi_wallenius_lpmf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real multi_wallenius_lpmf </td>
          <td>(</td>
          <td class="paramtype">data array[]int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data array[]real&#160;</td>
          <td class="paramname"><em>x_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Multivariate Wallenius' Noncentral Hypergeometric Distribution</p>
<p >Note that Stan cannot estimate discrete parameters so the realizations k must be data. This is enforced via the integral. If one wants to estimate missing data then an approximation will have to be performed. This can be accomplished by updating the function to take in a vector instead of an array of integers.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Sean Pinkney 2021</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Array of integer data </td></tr>
    <tr><td class="paramname">m</td><td>Vector of population margin sizes </td></tr>
    <tr><td class="paramname">p</td><td>Simplex of margin probabilities </td></tr>
    <tr><td class="paramname">x_r</td><td>Array of data (real) </td></tr>
    <tr><td class="paramname">tol</td><td>Tolerance of integration function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>log probability </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
     toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
     toggleButton.title = "Toggle Light/Dark Mode"
     $(document).ready(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
     $(window).resize(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
   })
</script>
</body>
</html>